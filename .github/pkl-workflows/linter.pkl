amends "package://pkg.pkl-lang.org/github.com/stefma/pkl-gha/com.github.action@0.0.3#/GitHubAction.pkl"
import "modules/Steps.pkl"

name = "Lint Codebase"

on {
  pull_request {}
  push {
    branches {
      "main"
    }
  }
}

permissions {
  contents = "read"
  packages = "read"
  statuses = "write"
}

jobs {
  ["test-typescript"] {
    name = "Lint Codebase"
    `runs-on` = "ubuntu-latest"
    steps {
      (Steps.checkout) {
        with {
          ["fetch-depth"] = 0
        }
      }
      Steps.installNode
      Steps.installNodeDeps
      new {
        name = "Lint Codebase"
        uses = "super-linter/super-linter/slim@v6"
        env {
          ["DEFAULT_BRANCH"] = "main"
          ["FILTER_REGEX_EXCLUDE"] = "dist/**/*"
          ["GITHUB_TOKEN"] = "${{ secrets.GITHUB_TOKEN }}"
          ["VALIDATE_ALL_CODEBASE"] = "true"
          ["VALIDATE_JAVASCRIPT_STANDARD"] = "false"
          ["VALIDATE_JSCPD"] = "false"
          ["VALIDATE_TYPESCRIPT_STANDARD"] = "false"
        }
      }
    }
  }
}